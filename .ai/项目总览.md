# Destra 项目总览

> Destra 是一个为 Desmos 图形计算器爱好者设计的编程框架，让用户能够通过代码来构建和管理复杂的数学图表。

## 项目背景

Desmos 是一个强大的数学可视化平台，但在处理复杂图表时，其原生界面存在一些局限性。当我们需要管理大量表达式、处理复杂的依赖关系，或者需要程序化地生成图表时，手动操作变得非常繁琐。

Destra 正是为了解决这些问题而生。它提供了一个编程化的框架，让用户能够用代码方便地构建 Desmos 图表，同时保持数学表达的自然性和直观性。

另外，Destra 计划与 PerSpatia: Ad Destra (PSADestra) 项目深度集成，将 Desmos 图表创作引入画布式编程环境。PSADestra 是一个画布式的编程环境，探索画布式、交互式、声明式创作工具的开发，为 Destra 提供了全新的使用方式，让更多 Desmos 爱好者能够通过直观的图形界面来使用 Destra 的功能。

### PSADestra 项目背景

PSADestra 项目起步于对更大项目（Para/Parasee）愿景的探索，采用 AI 协作开发、快速原型验证的技术路线。项目已经完成了基础画布系统、交互式控件、实时执行等核心功能，并确认采用 React 19.0 + TypeScript + Vite + React Flow + TailwindCSS + Zustand 的技术栈。

### 集成愿景

通过 Destra 与 PSADestra 的集成，创作者可以在画布中编写代码并实时预览 Desmos 图表，从面向编程用户扩展到更广泛的可视化创作群体。这种集成将实现：

- **画布式编程体验** - 在画布上创建和编辑代码块，支持拖拽、缩放等操作
- **交互式数学创作** - 通过滑动条、输入框等控件调整数学参数，实现实时调节
- **声明式/响应式创作** - 数据变更自动同步到所有依赖元素，减少重复劳动
- **Desmos 无缝预览** - 代码修改后立即在 Desmos 中查看效果

## 核心愿景

我们希望通过 Destra 实现以下目标：

**让数学创作更自然** - 提供接近数学表达习惯的语法，让创作者能够直观地编写表达式，而不需要适应复杂的编程语法。

**简化复杂图表的构建** - 通过编程方式管理大量表达式，自动处理依赖关系，避免手动操作中的错误和重复工作。

**提供强大的扩展能力** - 支持可扩展的公式组合，让用户能够构建可重用的数学组件和模板。

**实现实时反馈** - 提供高效的开发体验，表达式修改后能立即在预览中查看效果，形成快速迭代的创作循环。

## 设计哲学：双模式策略

为了平衡开发的快捷性、框架的易用性与功能的完备性，Destra 采用了“默认模式”与“Gentsin模式”的双模式设计策略。

-   **默认模式 (Default Mode)**：这是项目当前**优先开发和推荐使用**的模式。它旨在提供一个高度封装、专注于表达式组合与复用的工具框架，为此它主动简化或禁用了Desmos中部分会导致设计复杂化的原生特性（如悬空依赖、强上下文绑定等），以换取更强的工程确定性和更简洁的API。

-   **Gentsin 模式**：这是一个**长期探索性**方向，旨在提供一个能精细操作Desmos底层表达式对象的“黑科技”工具集。它将追求对Desmos所有原生功能的完全建模，但实现难度高，目前处于概念规划阶段。

这一策略使我们能快速交付一个稳定、易用的核心库（默认模式），同时为未来的深度探索保留了空间。

## 技术路线演进

项目在发展过程中经历了数次重要的技术与设计决策，这些决策共同塑造了 Destra 当前的形态。以下是关键节点的摘要：

-   **25年8月7日：确立JS优先的技术路线**
    -   在对 Julia 和 JavaScript 两条技术路线进行综合评估后，考虑到与 PSADestra 项目的协同需求、开发效率及生态成熟度，我们正式确立了 JavaScript 为项目优先开发语言。
    -   *详情请参阅：[技术设计笔记-250807](./技术设计记录/技术设计笔记-250807.md)*

-   **25年10月3日：确立双轨制开发策略**
    -   为解决“框架易用性”与“底层灵活性”的设计冲突，我们正式提出了“默认模式”与“Genshin模式”的双轨开发策略，并决定当前阶段集中资源开发“默认模式”。
    -   *详情请参阅：[技术设计笔记-251003](./技术设计记录/技术设计笔记-251003.md)*

-   **25年10月10日-19日：确定默认模式的一系列关键设计**
    -   可变 ID 体系，封装导出方案，DevEx 增强方案，多版本(variants, monorepo)并行开发方案等。
    -   *详情请参阅：[技术设计笔记-251010](./技术设计记录/技术设计笔记-251010.md)*

-   **25年10月16日：变更命名方案：Destra.js 与 PerSpatia: Ad Destra 项目**
    -   变更命名方案：Destra.js 与 PerSpatia: Ad Destra 项目。
    -   *详情请参阅：[命名设计笔记-251016](./技术设计记录/命名设计笔记-251016.md)*



## 项目状态

目前项目处于重新规划和文档重构阶段。我们正在：

1. **更新技术文档** - 重写核心文档，建立一个关于Desmos系统建模的良好知识库，并明确 JS 优先的技术路线。
2. **完善设计文档** - 详细设计 JavaScript 环境下的架构和实现方案
3. **建立开发流程** - 制定与 PSADestra 协同发展的开发计划

## 开发者

- static

## 常见问题

**Q: Destra 与 Desmos 官方 API 有什么区别？**

A: Destra 是一个社区项目，不是 Desmos 官方产品。它提供了一个编程框架来构建 Desmos 图表，而 Desmos 官方 API 主要是为了在网页中嵌入 Desmos 计算器。Destra 更专注于提供编程化的图表构建能力。

**Q: 为什么选择 JavaScript 而不是 Julia？**

A: 虽然 Julia 在数学表达方面有天然优势，但考虑到与 PSADestra 项目的协同发展需求，以及前端生态的成熟度，JavaScript 在当前阶段是更合适的选择。我们保留了 Julia 路线的探索，作为未来的备选方案。

**Q: Destra 如何处理复杂的数学表达式？**

A: Destra 设计了专门的表达式建模系统，支持变量引用、函数调用、运算表达式等基本元素，并提供依赖关系管理，确保表达式之间的逻辑一致性。

**Q: 项目的当前主要挑战是什么？**

A: 当前主要挑战包括：完善 JavaScript 环境下的表达式建模、设计与 PSADestra 的集成方案、建立高效的开发体验等。 
