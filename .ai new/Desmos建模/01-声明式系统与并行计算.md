# 01 - 声明式系统与并行计算

本文档介绍 Desmos 公式系统的基础——它的声明式特性。理解这一点，是后续所有深入分析的前提。

## Desmos 的世界观：声明，而非指令

在 JavaScript 等传统语言中，代码是一系列**指令(Instructions)**，被逐行执行。`let y = x + 1` 的意思是“立即计算 `x + 1` 的**值**，并将这个**结果**存入名为 `y` 的存储空间”。

而在 Desmos 中，公式列表中的每一行都是一个**声明(Declaration)**。`y = x + 1` 的意思是“在此声明 `y` 与 `x + 1` 之间存在一个永恒的**关系**”。Desmos 并不立即计算，而是构建一个关系网络。

这个网络是一个**有向无环图 (DAG, Directed Acyclic Graph)**，其中每个符号（如 `x`, `y`）和表达式都是图中的节点。

## 并行计算模型

由于 Desmos 的声明式特性，公式列表中的所有公式在逻辑上都是**并行存在**的，它们的书写顺序除了影响视觉上的层叠外，不影响计算逻辑。

你可以想象，当任何一个节点（比如一个滑块 `x`）的值发生变化时，这个变化会瞬间沿着 DAG 中所有依赖它的路径传播出去，所有相关的节点都会**同时**进行重新计算，并更新自己的状态。整个系统像一张巨大的电子表格，牵一发而动全身。

## 唯一的“指令”：Actions

Desmos 系统中唯一接近“指令”概念的是 **Actions**。一个 Action 可以被用户点击触发，它的作用是**原子性地更新一个或多个变量的状态**。

例如，一个 Action 可以定义为 `a -> a + 1, b -> 0`。当它被触发时，Desmos 会执行一次状态转换：计算 `a+1` 的新值赋给 `a`，同时将 `b` 设为 `0`。这个更新被视为一个独立的、瞬时完成的事件。在这次更新完成后，新的状态会再次沿着整个 DAG 传播，更新所有依赖 `a` 和 `b` 的公式。

理解 Actions 的关键在于，它本身不是计算过程的一部分，而是**触发计算的外部事件**。系统在两次 Action 之间处于一个稳定的、由声明式关系定义的平衡状态。
