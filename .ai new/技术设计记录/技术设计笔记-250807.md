# 技术选型笔记 - 250807

> 本文档记录了 Bernard 项目在 2025 年 8 月 7 日进行的关键技术选型决策过程，主要内容是从《项目总览》中迁移而来。

## 技术路线演进

### 技术选择历程

在 Bernard 和 Desmos Canvas 两个项目的开发过程中，我们同时考虑了两个技术路线：Julia 和 JavaScript。这个选择需要从两个项目的整体视角来评估。

**Julia 路线的优势**：
- **数学表达自然** - Julia 的语法极其接近数学表达习惯，支持隐式乘法、Unicode 数学符号等
- **元编程能力强** - 通过宏系统可以捕获和处理表达式，提供强大的代码生成能力
- **科学计算生态丰富** - 有成熟的符号计算库和数学工具链

**JavaScript 路线的优势**：
- **前后端开发生态丰富** - 有成熟的前端框架、工具链和社区支持
- **易学易用** - 对大多数开发者而言更熟悉，学习成本较低
- **架构简化** - Desmos Canvas 可以采取更简单的无后端架构
- **部署便利** - 纯前端应用部署简单，用户可以直接在浏览器中使用

### 架构影响分析

**Desmos Canvas 的架构选择**：
- **JavaScript 路线**：可以采取无后端架构，前端直接处理所有逻辑
- **Julia 路线**：必须开发 Julia 后端，并将前端打包成 Tauri 应用

**Bernard 的使用体验**：
Bernard 的使用体验受两个方面影响：
- **表达式创建的语法简洁程度** - Julia 在前者所能支持的语法设计方案一定程度上胜过 JavaScript 里的方案
- **对表达式对象进行自定义程序化操作的难易程度** - 对于后者，编程化处理，JavaScript 可能比 Julia 好很多

### 最终决策

经过综合考虑，我们选择在这两个项目中首先进行 JavaScript 路线的开发，Julia 作为第二选项，有机会也会开发。这个选择既考虑了技术优势，也考虑了开发效率和项目协同的需求。

### 技术架构设计
> note: this is not exact, later edit
Bernard 采用分层架构设计，主要包括以下几个核心层次：

**表达式层** - 处理数学表达式的建模和操作，包括变量引用、函数调用、运算表达式等基本元素。

**公式层** - 管理完整的 Desmos 公式，包含表达式内容、类型、绘图属性、滑动条属性等所有相关信息。

**图表层** - 组织完整的 Desmos 图表，管理公式列表、依赖关系图、全局设置等。

**依赖管理层** - 自动识别和处理表达式之间的依赖关系，构建依赖图，检查循环依赖和命名冲突。
